#!/bin/sh

current_display_id=$(yabai -m query --displays --display | jq '.id')
target_display_id=$(yabai -m query --displays | jq --arg id "$current_display_id" 'map(select(.id | tostring != $id))[0].id')
first_display_id=$(yabai -m query --displays | jq --arg id "$current_display_id" '.[0].id')
target_display_index=$(if [ "$target_display_id" == "$first_display_id" ]; then echo 1; else echo 2; fi)

current_app=$(yabai -m query --windows --window | jq ".app")
target_window_ids=$(yabai -m query --windows | jq --arg app "$current_app" 'map(select(.app==($app | fromjson))) | .[].id')

echo "$target_window_ids" | tr ' ' '\n' | while read id; do
    yabai -m window "$id" --display "$target_display_index"
    yabai -m window "$id" --grid 1:1:0:0:1:1
    yabai -m display --focus "$target_display_index"
done
